// Level 3: "The Final Tuning" - Lair + City Reshaping Battle
const LEVEL3_DATA = {
    name: 'The Final Tuning',
    width: 140,
    height: 17,
    tileWidth: TILE_SIZE,
    tileHeight: TILE_SIZE,
    background: 'bg_lair',
    backgroundMid: 'bg_boss_arena',
    tileTexture: 'ground_lair',
    platformTexture: 'platform_lair',
    wallTexture: 'wall_lair',
    music: 'music_level2',

    tiles: [
        // Row 0
        [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
        // Row 1
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 2
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 3
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 4
        [3,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 5
        [3,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 6
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 7
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 8
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 9
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 10
        [3,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,3],
        // Row 11
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 12
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 13
        [3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],
        // Row 14 - ground (tiles adjacent to pits changed from 1->2 so player can jump out)
        [1,1,1,1,1,1,1,1,2,2,0,0,0,2,2,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,2,2,1,1,1,2,2,0,0,0,2,2,1,1,1,1,2,2,0,0,0,2,2,1,1,1,1,2,2,0,0,0,2,2,1,1,1,2,2,0,0,0,2,2,1,1,1,1,2,2,0,0,0,2,2,1,1,1,1,1,2,2,0,0,0,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        // Row 15 (pit walls removed - air around hazards so player can jump out)
        [1,1,1,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        // Row 16 (pit walls removed)
        [1,1,1,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,0,0,4,4,4,0,0,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,0,0,4,4,4,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],

    playerSpawn: { x: 80, y: 280 },

    checkpoints: [
        { x: 700, y: 400 },
        { x: 1500, y: 400 },
        { x: 2500, y: 400 },
        { x: 3300, y: 400 },
    ],

    enemies: [
        { type: 'grunt', x: 250, y: 400, patrolMin: 200, patrolMax: 450 },
        { type: 'grunt', x: 500, y: 400, patrolMin: 450, patrolMax: 650 },
        { type: 'grunt', x: 750, y: 400, patrolMin: 700, patrolMax: 900 },
        { type: 'wall', x: 1000, y: 400, patrolMin: 950, patrolMax: 1200 },
        { type: 'grunt', x: 1200, y: 400, patrolMin: 1150, patrolMax: 1400 },
        { type: 'grunt', x: 1500, y: 400, patrolMin: 1450, patrolMax: 1650 },
        { type: 'wall', x: 1800, y: 400, patrolMin: 1700, patrolMax: 2000 },
        { type: 'grunt', x: 2000, y: 400, patrolMin: 1950, patrolMax: 2200 },
        { type: 'grunt', x: 2200, y: 400, patrolMin: 2150, patrolMax: 2400 },
        { type: 'grunt', x: 2500, y: 400, patrolMin: 2450, patrolMax: 2700 },
        { type: 'wall', x: 2800, y: 400, patrolMin: 2700, patrolMax: 3000 },
        { type: 'grunt', x: 3100, y: 400, patrolMin: 3050, patrolMax: 3250 },
    ],

    collectibles: [
        { type: 'health', x: 200, y: 380 },
        { type: 'tuning', x: 400, y: 100 },
        { type: 'memory', x: 600, y: 200 },
        { type: 'health', x: 850, y: 380 },
        { type: 'tuning', x: 1050, y: 130 },
        { type: 'memory', x: 1250, y: 210 },
        { type: 'health', x: 1450, y: 380 },
        { type: 'tuning', x: 1650, y: 100 },
        { type: 'health', x: 1900, y: 380 },
        { type: 'tuning', x: 2100, y: 150 },
        { type: 'memory', x: 2350, y: 200 },
        { type: 'health', x: 2600, y: 380 },
        { type: 'tuning', x: 2850, y: 120 },
        { type: 'health', x: 3100, y: 380 },
    ],

    crates: [
        { x: 350, y: 420 },
        { x: 1100, y: 420 },
        { x: 1700, y: 420 },
        { x: 2300, y: 420 },
        { x: 2900, y: 420 },
    ],

    midnightTriggers: [1000, 2000, 3000],

    shiftablePlatforms: [
        { x: 1024, y: 256, newX: 1024, newY: 160 },
        { x: 2048, y: 256, newX: 2048, newY: 320 },
        { x: 3072, y: 256, newX: 3072, newY: 192 },
    ],

    bossTriggerX: 3600,
    bossSpawn: { x: 3900, y: 350 },
    bossArena: { left: 3520, right: 4480, top: 0, bottom: 544 },
    exit: { x: 4350, y: 400 },
};
